<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>docs.cet-t.net | Documentation</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;500;600&family=Source+Serif+4:wght@400;600&family=JetBrains+Mono&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="https://github.com/cet-t.png" />
    <style>
      :root {
        --docs-bg: #262626;
        --docs-sidebar: #353535;
        --docs-orange: #f46623;
        --docs-text: #ddd;
        --docs-text-dim: #999;
        --docs-border: #444;
        --docs-link: #d2991d;
        --docs-hover: #ffffff;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background-color: var(--docs-bg);
        color: var(--docs-text);
        font-family: "Fira Sans", sans-serif;
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
      }

      header {
        background-color: var(--docs-sidebar);
        height: 50px;
        display: flex;
        align-items: center;
        padding: 0 1rem;
        border-bottom: 1px solid var(--docs-border);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-logo {
        display: flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        color: var(--docs-text);
        font-weight: 600;
        font-size: 1.1rem;
      }

      .header-logo img {
        height: 32px;
        filter: brightness(0) invert(1);
      }

      .search-container {
        flex: 1;
        display: flex;
        justify-content: center;
        padding: 0 2rem;
        position: relative;
      }

      .search-container input {
        width: 100%;
        max-width: 600px;
        background-color: #454545;
        border: 1px solid #5a5a5a;
        border-radius: 3px;
        padding: 5px 10px;
        color: white;
        font-family: "Fira Sans", sans-serif;
        outline: none;
      }

      .search-container input::placeholder {
        color: #888;
      }

      .search-results {
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        max-width: 600px;
        background: #313131;
        border: 1px solid var(--docs-border);
        border-top: none;
        border-radius: 0 0 4px 4px;
        z-index: 100;
        display: none;
        max-height: 300px;
        overflow-y: auto;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
      }

      .search-result-item {
        padding: 10px 15px;
        cursor: pointer;
        border-bottom: 1px solid #444;
        font-size: 0.9rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--docs-text);
        text-align: left;
      }

      .search-result-item:hover,
      .search-result-item.selected {
        background: var(--docs-orange);
        color: white;
      }

      .search-result-item .item-type {
        font-size: 0.7rem;
        background: rgba(255, 255, 255, 0.1);
        padding: 2px 6px;
        border-radius: 3px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      main {
        max-width: 1000px;
        margin: 40px auto;
        padding: 0 20px;
      }

      h1 {
        font-family: "Source Serif 4", serif;
        font-size: 2.5rem;
        margin-bottom: 2rem;
        font-weight: 600;
      }

      .crate-section {
        margin-bottom: 3rem;
      }

      .crate-section h2 {
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--docs-text-dim);
        border-bottom: 1px solid var(--docs-border);
        padding-bottom: 10px;
        margin-bottom: 20px;
      }

      .crate-list {
        list-style: none;
      }

      .crate-item {
        background-color: #2b2b2b;
        border: 1px solid var(--docs-border);
        border-radius: 4px;
        padding: 20px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        transition:
          border-color 0.2s,
          transform 0.2s;
      }

      .crate-item:hover {
        border-color: var(--docs-orange);
        transform: translateY(-2px);
      }

      .crate-info {
        display: flex;
        gap: 15px;
      }

      .crate-icon {
        font-size: 1.5rem;
        color: var(--docs-orange);
        margin-top: 5px;
      }

      .crate-name {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--docs-link);
        text-decoration: none;
        margin-bottom: 5px;
        display: inline-block;
      }

      .crate-name:hover {
        text-decoration: underline;
      }

      .crate-version {
        font-family: "JetBrains Mono", monospace;
        font-size: 0.8rem;
        color: var(--docs-text-dim);
        background: #3a3a3a;
        padding: 2px 6px;
        border-radius: 3px;
        margin-left: 10px;
      }

      .crate-desc {
        color: var(--docs-text-dim);
        font-size: 0.95rem;
        margin-top: 5px;
      }

      .crate-links {
        display: flex;
        gap: 15px;
      }

      .crate-links a {
        color: var(--docs-text-dim);
        text-decoration: none;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: color 0.2s;
      }

      .crate-links a:hover {
        color: var(--docs-orange);
      }

      .hero {
        background-color: #353535;
        padding: 60px 20px;
        text-align: center;
        border-bottom: 1px solid var(--docs-border);
        margin-bottom: 40px;
      }

      .hero h1 {
        margin-bottom: 10px;
      }

      .hero p {
        color: var(--docs-text-dim);
        font-size: 1.1rem;
      }

      @media (max-width: 600px) {
        .crate-item {
          flex-direction: column;
          gap: 15px;
        }
        .crate-links {
          width: 100%;
          justify-content: flex-start;
          padding-top: 10px;
          border-top: 1px solid var(--docs-border);
        }
        header .search-container {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <a href="/" class="header-logo">
        <i class="fas fa-cube" style="color: var(--docs-orange)"></i>
        <span>docs.cet-t.net</span>
      </a>
      <div class="search-container">
        <input
          type="text"
          id="search-input"
          placeholder="Search documentation..."
          autocomplete="off"
        />
        <div id="search-results" class="search-results"></div>
      </div>
    </header>

    <div class="hero">
      <h1>Platform Documentation</h1>
      <p>Modular and High Performance Libraries for Unity & beyond.</p>
    </div>

    <main>
      <div class="crate-section">
        <h2>Hosted Crates</h2>
        <ul class="crate-list">
          <li class="crate-item">
            <div class="crate-info">
              <div class="crate-icon"><i class="fas fa-bolt"></i></div>
              <div>
                <a href="unilox/index.html" class="crate-name">unilox</a>
                <span class="crate-version" id="unilox-version">v1.2.0</span>
                <div class="crate-desc">
                  Ultra-fast, low-memory footprint random number generation
                  library for Unity. Powered by Rust.
                </div>
              </div>
            </div>
            <div class="crate-links">
              <a href="unilox/index.html"><i class="fas fa-book"></i> Docs</a>
              <a href="unilox/ja/about.html"
                ><i class="fas fa-home"></i> Home</a
              >
              <a href="https://github.com/cet-t/unilox" target="_blank"
                ><i class="fas fa-code"></i> Source</a
              >
            </div>
          </li>

          <li class="crate-item">
            <div class="crate-info">
              <div class="crate-icon"><i class="fas fa-random"></i></div>
              <div>
                <a href="rng/index.html" class="crate-name">rng</a>
                <span class="crate-version" id="rng-version">v0.5.4</span>
                <div class="crate-desc">
                  Modular implementations of various random number generation
                  algorithms.
                </div>
              </div>
            </div>
            <div class="crate-links">
              <a href="rng/index.html"><i class="fas fa-book"></i> Docs</a>
              <a href="https://crates.io/crates/rng-pack" target="_blank"
                ><i class="fas fa-home"></i> Home</a
              >
              <a
                href="https://docs.rs/rng-pack/latest/src/rng_pack/lib.rs.html"
                target="_blank"
                ><i class="fas fa-code"></i> Source</a
              >
            </div>
          </li>
        </ul>
      </div>
    </main>

    <script>
      const searchData = [
        { name: "unilox", type: "Project", url: "unilox/index.html" },
        { name: "rng", type: "Project", url: "rng/index.html" },
        {
          name: "Philox",
          type: "Algorithm",
          url: "unilox/ja/index.html#algorithms",
        },
        {
          name: "Xorshift",
          type: "Algorithm",
          url: "unilox/ja/index.html#algorithms",
        },
        {
          name: "Mersenne Twister",
          type: "Algorithm",
          url: "unilox/ja/index.html#algorithms",
        },
        { name: "IRng32", type: "API", url: "unilox/ja/index.html#api-rng32" },
        { name: "IRng64", type: "API", url: "unilox/ja/index.html#api-rng64" },
        {
          name: "Unilox Installation",
          type: "Docs",
          url: "unilox/ja/index.html#install",
        },
        {
          name: "Benchmarks",
          type: "Section",
          url: "unilox/ja/about.html#performance-comparison",
        },
      ];

      const searchInput = document.getElementById("search-input");
      const searchResults = document.getElementById("search-results");
      let selectedIndex = -1;

      searchInput.addEventListener("input", (e) => {
        const query = e.target.value.toLowerCase();
        if (!query) {
          searchResults.style.display = "none";
          return;
        }

        const filtered = searchData.filter(
          (item) =>
            item.name.toLowerCase().includes(query) ||
            item.type.toLowerCase().includes(query),
        );

        if (filtered.length > 0) {
          searchResults.innerHTML = filtered
            .map(
              (item, index) => `
            <div class="search-result-item" onclick="window.location.href='${item.url}'">
              <span>${item.name}</span>
              <span class="item-type">${item.type}</span>
            </div>
          `,
            )
            .join("");
          searchResults.style.display = "block";
        } else {
          searchResults.style.display = "none";
        }
        selectedIndex = -1;
      });

      searchInput.addEventListener("keydown", (e) => {
        const items =
          searchResults.getElementsByClassName("search-result-item");
        if (e.key === "ArrowDown") {
          selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
          updateSelection(items);
        } else if (e.key === "ArrowUp") {
          selectedIndex = Math.max(selectedIndex - 1, -1);
          updateSelection(items);
        } else if (e.key === "Enter") {
          if (selectedIndex > -1) {
            items[selectedIndex].click();
          } else if (items.length > 0) {
            items[0].click();
          }
        }
      });

      function updateSelection(items) {
        Array.from(items).forEach((item, i) => {
          item.classList.toggle("selected", i === selectedIndex);
        });
      }

      document.addEventListener("click", (e) => {
        if (
          !searchInput.contains(e.target) &&
          !searchResults.contains(e.target)
        ) {
          searchResults.style.display = "none";
        }
      });

      // Version Sync Script
      async function syncVersions() {
        const repos = [
          {
            type: "github",
            owner: "cet-t",
            repo: "unilox",
            elementId: "unilox-version",
          },
          { type: "crates", crate: "rng-pack", elementId: "rng-version" },
        ];

        for (const item of repos) {
          try {
            if (item.type === "github") {
              const response = await fetch(
                `https://api.github.com/repos/${item.owner}/${item.repo}/releases/latest`,
              );
              if (response.ok) {
                const data = await response.json();
                document.getElementById(item.elementId).textContent =
                  data.tag_name;
              }
            } else if (item.type === "crates") {
              const response = await fetch(
                `https://crates.io/api/v1/crates/${item.crate}`,
              );
              if (response.ok) {
                const data = await response.json();
                document.getElementById(item.elementId).textContent =
                  "v" + data.crate.max_version;
              }
            }
          } catch (e) {
            console.warn(
              `Failed to sync version for ${item.repo || item.crate}`,
              e,
            );
          }
        }
      }

      syncVersions();
    </script>
  </body>
</html>
