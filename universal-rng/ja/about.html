<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Universal RNG - crates.io: Rust package registry</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@300;400;500;600&family=Source+Serif+4:wght@400;600&family=JetBrains+Mono&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="https://github.com/cet-t.png" />
    <style>
      :root {
        --crates-bg: #262626;
        --crates-surface: #353535;
        --crates-orange: #f46623;
        --crates-text: #ddd;
        --crates-text-dim: #999;
        --crates-link: #d2991d;
        --crates-border: #444;
        --crates-card: #2b2b2b;
        --docs-border: #444;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background-color: var(--crates-bg);
        color: var(--crates-text);
        font-family: "Fira Sans", sans-serif;
        line-height: 1.6;
        min-height: 100vh;
      }

      /* Nav Header */
      header {
        background-color: var(--crates-surface);
        border-bottom: 1px solid var(--crates-border);
        padding: 0.8rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .header-logo {
        color: var(--crates-orange);
        font-size: 1.8rem;
        text-decoration: none;
      }

      .search-container {
        position: relative;
      }

      .search-bar {
        background: #454545;
        border: 1px solid #555;
        border-radius: 4px;
        padding: 6px 12px;
        width: 400px;
        color: white;
        outline: none;
      }

      .search-results {
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        background: #313131;
        border: 1px solid var(--crates-border);
        border-top: none;
        border-radius: 0 0 4px 4px;
        z-index: 100;
        display: none;
        max-height: 300px;
        overflow-y: auto;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
      }

      .search-result-item {
        padding: 10px 15px;
        cursor: pointer;
        border-bottom: 1px solid #444;
        font-size: 0.9rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .search-result-item:hover,
      .search-result-item.selected {
        background: var(--crates-orange);
        color: white;
      }

      .search-result-item .item-type {
        font-size: 0.7rem;
        background: rgba(255, 255, 255, 0.1);
        padding: 2px 6px;
        border-radius: 3px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Crate Hero Area */
      .crate-header {
        background-color: #313131;
        padding: 3rem 0 0;
        border-bottom: 1px solid var(--crates-border);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      .crate-title-row {
        display: flex;
        align-items: flex-end;
        gap: 15px;
        margin-bottom: 2rem;
      }

      .crate-name {
        font-family: "Source Serif 4", serif;
        font-size: 3rem;
        font-weight: 600;
        color: #fff;
      }

      .crate-version {
        font-size: 1.2rem;
        color: var(--crates-text-dim);
        margin-bottom: 8px;
      }

      /* Tabs */
      .tabs {
        display: flex;
        gap: 2px;
      }

      .tab {
        padding: 10px 20px;
        background: transparent;
        border: 1px solid transparent;
        border-bottom: none;
        color: var(--crates-text-dim);
        text-decoration: none;
        font-weight: 500;
        border-radius: 4px 4px 0 0;
      }

      .tab.active {
        background: var(--crates-bg);
        border-color: var(--crates-border);
        color: var(--crates-orange);
      }

      /* Main Content Layout */
      .main-layout {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 40px;
        padding: 40px 0;
      }

      /* Content Area (Readme) */
      .readme-content h2 {
        font-family: "Source Serif 4", serif;
        font-size: 1.8rem;
        margin: 2.5rem 0 1rem;
        border-bottom: 1px solid var(--crates-border);
        padding-bottom: 5px;
        color: #fff;
      }

      .readme-content p {
        margin-bottom: 1.2rem;
        color: var(--crates-text);
      }

      .readme-content p strong {
        color: var(--crates-orange);
      }

      /* Code Blocks */
      .pre {
        background: #1d1f21 !important; /* Official Coal background */
        padding: 1.2rem;
        border-radius: 6px;
        border: 1px solid var(--crates-border);
        overflow-x: auto;
        margin: 1.5rem 0;
        color: #c5c8c6 !important; /* Default Coal text */
      }

      code {
        font-family: "JetBrains Mono", monospace;
        font-size: 0.85rem;
      }

      .keyword {
        color: #b294bb !important; /* Keyword: Muted Purple */
      }
      .type {
        color: #81a2be !important; /* Type/Class: Steel Blue */
      }
      .method {
        color: #b5bd68 !important; /* Method: Sage Green */
      }
      .comment {
        color: #969896 !important; /* Comment: Cool Gray */
        font-style: italic !important;
      }

      /* Benchmarks Table-like */
      .benchmark-box {
        background: var(--crates-card);
        border: 1px solid var(--crates-border);
        padding: 20px;
        border-radius: 6px;
        margin-top: 1.5rem;
      }

      .chart-row {
        margin-bottom: 15px;
      }

      .bar-label {
        display: flex;
        justify-content: space-between;
        font-size: 0.85rem;
        margin-bottom: 5px;
        color: var(--crates-text-dim);
      }

      .bar-bg {
        height: 10px;
        background: #444;
        border-radius: 5px;
        overflow: hidden;
      }

      .bar-fill {
        height: 100%;
        background: var(--crates-orange);
      }

      /* Sidebar Styling */
      .sidebar {
        display: flex;
        flex-direction: column;
        gap: 30px;
      }

      .sidebar-section h3 {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--crates-text-dim);
        border-bottom: 1px solid var(--crates-border);
        padding-bottom: 8px;
        margin-bottom: 12px;
      }

      .sidebar-link {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--crates-link);
        text-decoration: none;
        font-size: 0.95rem;
        margin-bottom: 8px;
      }

      .sidebar-link:hover {
        text-decoration: underline;
      }

      .install-box {
        background: #111;
        padding: 12px;
        border-radius: 4px;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.85rem;
        color: #ccc;
        border: 1px solid #333;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
      }

      .install-box:hover {
        border-color: var(--crates-orange);
      }

      /* Labels / Badges */
      .label {
        background: #3a3a3a;
        color: #ddd;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        margin-right: 5px;
      }

      .owner-link {
        display: flex;
        gap: 8px;
        margin-top: 10px;
        text-decoration: none;
        color: inherit;
        transition: opacity 0.2s;
        width: fit-content;
      }

      .owner-link:hover {
        opacity: 0.8;
      }

      /* Dropdown Menu */
      .dropdown {
        position: relative;
        display: inline-block;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        background-color: var(--crates-surface);
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.5);
        z-index: 1;
        border: 1px solid var(--crates-border);
        border-radius: 4px;
        margin-top: 5px;
      }

      .dropdown-content a {
        color: var(--crates-text);
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        font-size: 0.9rem;
        transition: background 0.2s;
      }

      .dropdown-content a:hover {
        background-color: #454545;
        color: var(--crates-orange);
      }

      .dropdown:hover .dropdown-content {
        display: block;
      }

      .dropdown:hover .tab {
        color: var(--crates-orange);
      }

      /* Responsive */
      @media (max-width: 900px) {
        .main-layout {
          grid-template-columns: 1fr;
        }
        .sidebar {
          order: -1;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-left">
        <a href="../../index.html" class="header-logo"
          ><i class="fas fa-box-open"></i
        ></a>
        <div class="search-container">
          <input
            type="text"
            id="search-input"
            class="search-bar"
            placeholder="Search for boxes or API..."
            autocomplete="off"
          />
          <div id="search-results" class="search-results"></div>
        </div>
      </div>
      <div class="header-right">
        <div class="dropdown">
          <a href="#" class="tab"
            ><i class="fas fa-language"></i> 言語
            <i class="fas fa-caret-down"></i
          ></a>
          <div class="dropdown-content">
            <a href="../ja/about.html">日本語</a>
            <a href="../en/about.html">English</a>
          </div>
        </div>
      </div>
    </header>

    <div class="crate-header">
      <div class="container">
        <div class="crate-title-row">
          <span class="crate-name">Universal RNG</span>
          <span class="crate-version" id="current-version">v0.1.0</span>
          <span class="label">MIT</span>
        </div>
      </div>
    </div>

    <main class="container">
      <div class="main-layout">
        <!-- Main Readme Content -->
        <article class="readme-content">
          <p>
            Universal RNG (URng) は、膨大な乱数の一括生成（Bulk
            Generation）に特化した、Unity
            向けの超高速・高品質乱数ライブラリです。
          </p>
          <ul style="list-style: none; padding-left: 0">
            <li style="margin-bottom: 0.8rem">
              <i
                class="fas fa-cubes"
                style="color: var(--crates-orange); margin-right: 8px"
              ></i
              ><strong>静的一括生成の極致</strong>:
              数百万、数億単位の乱数を一瞬でメモリに展開。地形生成や大規模シミュレーションのロード時間を劇的に短縮します。
            </li>
            <li style="margin-bottom: 0.8rem">
              <i
                class="fas fa-microchip"
                style="color: var(--crates-orange); margin-right: 8px"
              ></i
              ><strong>Rust × Burst の融合</strong>: Rust
              で設計された堅牢なアルゴリズムを Unity の Burst
              コンパイラで最適化し、ネイティブ性能を限界まで引き出しました。
            </li>
            <li style="margin-bottom: 0.8rem">
              <i
                class="fas fa-bolt"
                style="color: var(--crates-orange); margin-right: 8px"
              ></i
              ><strong>ゼロ・コピー設計</strong>: <code>Span&lt;T&gt;</code> API
              を通じて、メモリアロケーションを最小限に抑えた爆速のデータ提供を実現します。
            </li>
          </ul>
          <h2>実行速度の比較</h2>
          <p>
            Universal RNGは、標準の <code>UnityEngine.Random</code> や
            <code>System.Random</code> を凌駕するパフォーマンスを提供します。
            内部に Xorshift や Philox
            アルゴリズムを搭載し、SIMD最適化が施されています。
          </p>

          <div class="benchmark-box">
            <div class="chart-row">
              <div class="bar-label">
                <span>Universal RNG (Pcg32)</span><span>79.5 ms</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" style="width: 9%"></div>
              </div>
            </div>
            <div class="chart-row">
              <div class="bar-label">
                <span>Universal RNG (Sfc64)</span><span>82.0 ms</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" style="width: 9.4%"></div>
              </div>
            </div>
            <div class="chart-row">
              <div class="bar-label">
                <span>Universal RNG (Mt19937)</span><span>88.4 ms</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" style="width: 10.1%"></div>
              </div>
            </div>
            <div class="chart-row">
              <div class="bar-label">
                <span>Unity.Mathematics</span><span>403.9 ms</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" style="width: 46.3%; opacity: 0.4"></div>
              </div>
            </div>
            <div class="chart-row">
              <div class="bar-label">
                <span>UnityEngine.Random</span><span>761.3 ms</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" style="width: 87.4%; opacity: 0.4"></div>
              </div>
            </div>
            <div class="chart-row">
              <div class="bar-label">
                <span>System.Random</span><span>871.1 ms</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" style="width: 100%; opacity: 0.4"></div>
              </div>
            </div>
            <p
              style="
                font-size: 0.8rem;
                color: var(--crates-text-dim);
                margin-top: 10px;
                margin-bottom: 0;
              "
            >
              ※ 1億個の生成を10回試行した際の平均時間。
            </p>
          </div>

          <h2>直感的な使用例</h2>
          <p>
            シンプルかつスレッドセーフなAPI設計により、既存のプロジェクトに数分で組み込むことが可能です。
          </p>

          <pre class="pre"><code><span class="keyword">using</span> Cet.Rng;

<span class="comment">// Mersenne Twister (32bit): シード配列で初期化</span>
<span class="keyword">using var</span> mt = <span class="keyword">new</span> <span class="type">Mt19937</span>(1, 1024);
Debug.<span class="method">Assert</span>(mt.<span class="method">Next</span>() == 244660247);
<span class="comment">// 一括生成による高速化 (Span&lt;uint&gt;を返す)</span>
Debug.<span class="method">Assert</span>(mt.<span class="method">NextU32s</span>(3).<span class="method">SequenceEqual</span>(<span class="keyword">new</span> <span class="type">uint</span>[] 
{ 
    1183135446, 
    982747242, 
    221797415 
}));

<span class="comment">// Sfc64 (64bit): 高速でバランスの良いPRNG</span>
<span class="keyword">using var</span> sfc = <span class="keyword">new</span> <span class="type">Sfc64</span>(1);
Debug.<span class="method">Assert</span>(sfc.<span class="method">Next</span>() == 4613303445314885483);
Debug.<span class="method">Assert</span>(sfc.<span class="method">NextU64s</span>(3).<span class="method">SequenceEqual</span>(<span class="keyword">new</span> <span class="type">ulong</span>[] 
{ 
    9250377774926580674, 
    11474594222839663884, 
    10182195164632316717 
}));

<span class="comment">// PCG (32bit): 統計的性質に優れたPRNG</span>
<span class="keyword">using var</span> pcg = <span class="keyword">new</span> <span class="type">Pcg32</span>(1);
Debug.<span class="method">Assert</span>(pcg.<span class="method">Next</span>() == 4164751464);
Debug.<span class="method">Assert</span>(pcg.<span class="method">NextU32s</span>(3).<span class="method">SequenceEqual</span>(<span class="keyword">new</span> <span class="type">uint</span>[] 
{ 
    4202279039, 
    2817093042, 
    1081118559 
}));</code></pre>
        </article>

        <aside class="sidebar">
          <div class="sidebar-section">
            <h3>Install</h3>
            <div class="install-box">
              <span id="install-text">universal-rng = "0.1.0"</span>
              <i class="far fa-copy"></i>
            </div>
          </div>

          <div class="sidebar-section">
            <h3>Documentation</h3>
            <a href="index.html" class="sidebar-link"
              ><i class="fas fa-book"></i> API Reference</a
            >
            <a
              href="https://docs.rs/rng-pack/latest/rng_pack/"
              class="sidebar-link"
              ><i class="fas fa-external-link-alt"></i> docs.rs</a
            >
          </div>

          <div class="sidebar-section">
            <h3>Repository</h3>
            <a href="https://github.com/cet-t/unilox" class="sidebar-link"
              ><i class="fab fa-github"></i> cet-t/unilox</a
            >
          </div>

          <div class="sidebar-section">
            <h3>Owners</h3>
            <a
              href="https://github.com/cet-t"
              class="owner-link"
              target="_blank"
            >
              <img
                src="https://github.com/cet-t.png"
                style="width: 32px; height: 32px; border-radius: 4px"
              />
              <span style="font-size: 0.9rem; align-self: center">cet-t</span>
            </a>
          </div>

          <div class="sidebar-section">
            <h3>Category</h3>
            <div style="display: flex; flex-wrap: wrap; gap: 5px">
              <span class="label">Unity</span>
              <span class="label">RNG</span>
              <span class="label">Performance</span>
            </div>
          </div>

          <div class="sidebar-section">
            <h3>License</h3>
            <div style="display: flex; flex-wrap: wrap; gap: 5px">
              <span class="label">MIT</span>
            </div>
          </div>
        </aside>
      </div>
    </main>
    <script>
      const searchData = [
        { name: "Universal RNG", type: "Project", url: "../ja/about.html" },
        { name: "rng", type: "Project", url: "../../rng/index.html" },
        { name: "Philosophy", type: "Section", url: "about.html" },
        { name: "Philox", type: "Algorithm", url: "index.html#algorithms" },
        { name: "Xorshift", type: "Algorithm", url: "index.html#algorithms" },
        { name: "Sfc64", type: "Algorithm", url: "index.html#algorithms" },
        { name: "Cet64", type: "Algorithm", url: "index.html#algorithms" },
        {
          name: "Mersenne Twister",
          type: "Algorithm",
          url: "index.html#algorithms",
        },
        { name: "IRng32", type: "API", url: "index.html#api-rng32" },
        { name: "IRng64", type: "API", url: "index.html#api-rng64" },
        { name: "Installation", type: "Docs", url: "index.html#install" },
        {
          name: "Benchmarks",
          type: "Section",
          url: "about.html#performance-comparison",
        },
      ];

      const searchInput = document.getElementById("search-input");
      const searchResults = document.getElementById("search-results");
      let selectedIndex = -1;

      searchInput.addEventListener("input", (e) => {
        const query = e.target.value.toLowerCase();
        if (!query) {
          searchResults.style.display = "none";
          return;
        }

        const filtered = searchData.filter(
          (item) =>
            item.name.toLowerCase().includes(query) ||
            item.type.toLowerCase().includes(query),
        );

        if (filtered.length > 0) {
          searchResults.innerHTML = filtered
            .map(
              (item, index) => `
                    <div class="search-result-item" onclick="window.location.href='${item.url}'">
                        <span>${item.name}</span>
                        <span class="item-type">${item.type}</span>
                    </div>
                `,
            )
            .join("");
          searchResults.style.display = "block";
        } else {
          searchResults.style.display = "none";
        }
        selectedIndex = -1;
      });

      searchInput.addEventListener("keydown", (e) => {
        const items =
          searchResults.getElementsByClassName("search-result-item");
        if (e.key === "ArrowDown") {
          selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
          updateSelection(items);
        } else if (e.key === "ArrowUp") {
          selectedIndex = Math.max(selectedIndex - 1, -1);
          updateSelection(items);
        } else if (e.key === "Enter") {
          if (selectedIndex > -1) {
            items[selectedIndex].click();
          } else if (items.length > 0) {
            items[0].click();
          }
        }
      });

      function updateSelection(items) {
        Array.from(items).forEach((item, i) => {
          item.classList.toggle("selected", i === selectedIndex);
        });
      }

      document.addEventListener("click", (e) => {
        if (
          !searchInput.contains(e.target) &&
          !searchResults.contains(e.target)
        ) {
          searchResults.style.display = "none";
        }
      });

      // Version Sync Script
      async function syncVersion() {
        try {
          const response = await fetch(
            "https://api.github.com/repos/cet-t/unilox/releases/latest",
          );
          let tag = "";
          if (response.ok) {
            const data = await response.json();
            tag = data.tag_name;
          } else {
            const tagsResponse = await fetch(
              "https://api.github.com/repos/cet-t/unilox/tags",
            );
            const tagsData = await tagsResponse.json();
            if (tagsData && tagsData.length > 0) tag = tagsData[0].name;
          }

          if (tag) {
            const currentVersionElement =
              document.getElementById("current-version");
            if (currentVersionElement) currentVersionElement.textContent = tag;
            const versionOnly = tag.startsWith("v") ? tag.substring(1) : tag;
            const installTextElement = document.getElementById("install-text");
            if (installTextElement)
              installTextElement.textContent = `universal-rng = "${versionOnly}"`;
          }
        } catch (e) {
          console.warn("Failed to sync version", e);
        }
      }
      syncVersion();
    </script>
  </body>
</html>
